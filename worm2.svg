<?xml version="1.0" encoding="UTF-8" standalone="no" ?> 
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.0//EN" "http://www.w3.org/TR/SVG/DTD/svg10.dtd"> 
<svg xmlns="http://www.w3.org/2000/svg" 
onload="startup(evt)"
style='background-color: black' >
<!-- Author: Jan van der Meiden                                           -->
<!-- jvdmeiden@gmail.com                                                  -->
<!-- Version: 20140308.00                                                 -->
<!-- Copyright (c) 2014 Jan van der Meiden.                               -->
<!-- Copying and distribution of this file, with or without modification, -->
<!-- are permitted in any medium without royalty provided the copyright   -->
<!-- notice and this notice are preserved.                                -->

<script><![CDATA[
var SVGDoc = null;
var lineRoot = null;
var sq3=Math.sqrt(3);
var increment = 12;
var svgns = 'http://www.w3.org/2000/svg';
// the field contains information on what was eaten where, heavily relying on associative arrays
var field = new Object;
field = {"0":{"0":[false,false,false,false,false,false]}};
// currently allowing one worm, has x and y positiom and direction
var worm = [0,0,0];
var offsetX = window.innerWidth/2;
var offsetY = window.innerHeight/2;
var typeA = null;

// types follow naming as described on http://wso.williams.edu/~bchaffin/patersons_worms/allworms.htm

// setup translation of direction to coordinates
var dirs = [[1,0],[1,-1],[0,-1],[-1,0],[-1,1],[0,1]];
var colors = ["rgb(5,250,250)","rgb(250,5,250)","rgb(250,250,5)","rgb(250,5,5)","rgb(5,250,5)","rgb(5,5,250)"];
  
function startup(evt){
  SVGDoc = evt.target.ownerDocument;
  lineRoot = SVGDoc.getElementById("Lines"); 
}

function submitWorm(evt){
  typeWorm=document.getElementById( 'myWorm' ).value;
  console.log(typeWorm);
  typeString=typeWorm.split('--')[1];

  // setup type array
  typeA={ "0" : parseInt(typeString[0]) };
  typeString=typeString.substring(1,typeString.length);

  // clear field
  field = {"0":{"0":[false,false,false,false,false,false]}};
  worm = [0,0,0];
  
  // clear lines
  var element = document.getElementById("Lines");
  while (element.firstChild) {
    element.removeChild(element.firstChild);
  }
  
  setTimeout("tick()",20);
  return false;
}

function tick(evt){ 
  // console.log(JSON.stringify(field));
  // console.log(JSON.stringify(worm));
  console.log();
  
  var x = worm[0];
  var y = worm[1];
  var v = worm[2];
  
  // based on direction find the next field  
  var xn = x + dirs[v][0];
  var yn = y + dirs[v][1];
  
  // check if next field exist if not create
  if (field[xn] === undefined) {
    field[xn]=({});
  }
  if (field[xn][yn] === undefined) {
    field[xn][yn]=[false,false,false,false,false,false];
  }
  
  // draw the line and update field 
  draw(x,y,xn,yn);
  field[xn][yn][v]=true;
  field[x][y][(v+3)%6]=true;
  
  // update worm based on type,
  worm[0]=xn;
  worm[1]=yn;
  odir=worm[2];
  var typ=0;
  var cnt=0;
  
  for(var i=1; i<6 ; i++){
	typ*=2;
    if ( field[xn][yn][(i+odir)%6] == true ) {
	  typ += 1;
	  cnt += 1;
	}  
  };
  
  if (cnt<4){
    if(typeA[typ]===undefined){
      typeA[typ]=parseInt(typeString[0]);
      typeString=typeString.substring(1,typeString.length);    
    }
    worm[2]=(odir+typeA[typ])%6;
  } else {
    for(var i=0; i<6 ; i++){
      if ( field[xn][yn][i] == false ) {
	    worm[2]=(i+3)%6;
	  }  
   };
  
  }
 
  if ( typ != 31 ) setTimeout("tick()",0); 
}   

function draw(x1,y1,x2,y2){
  NewLine = SVGDoc.createElementNS(svgns,"circle"); 
  NewLine.setAttribute("cx", offsetX+(increment*(x1+y1/2)+increment*(x2+y2/2))/2); 
  NewLine.setAttribute("cy", offsetY-(sq3*increment*y1/2+sq3*increment*y2/2)/2); 
  NewLine.setAttribute("r", increment/4);
  NewLine.setAttribute("fill", colors[worm[2]]); 
  lineRoot.appendChild(NewLine); 
}

]]></script> 
  <foreignObject id="form" x="50" y="50" width="200" height="150">
    <body xmlns="http://www.w3.org/1999/xhtml">
	  <form onsubmit="return submitWorm()">
        
          <label for="myWorm">Pick a worm</label>
          <select id="myWorm" name="worm">
            <option>001--0--infinite</option>
            <option>002--1010001--295</option>
            <option>003--1010002--105</option>
            <option>004--1010005--67</option>
            <option>005--101001--33</option>
            <option>006--1010051--2155</option>
            <option>007--1010052--235</option>
            <option>008--1010055--1932</option>
            <option>009--101020--86</option>
            <option>010--101021--99</option>
            <option>011--1010251--327</option>
            <option>012--1010252--475</option>
            <option>013--1010255--61</option>
            <option>014--1010401--68</option>
            <option>015--1010402--196</option>
            <option>016--1010405--67</option>
            <option>017--101041--48</option>
            <option>018--1010451--1831</option>
            <option>019--1010452--684</option>
            <option>020--1010455--99</option>
            <option>021--1015001--85</option>
            <option>022--1015002--83</option>
            <option>023--1015005--96</option>
            <option>024--101501--48</option>
            <option>025--1015051--7524</option>
            <option>026--1015052--203</option>
            <option>027--1015055--67</option>
            <option>028--1015201--10460</option>
            <option>029--1015202--infinite</option>
            <option>030--1015205--infinite</option>
            <option>031--101521--29</option>
            <option>032--1015251--534</option>
            <option>033--1015252--4318</option>
            <option>034--1015255--93</option>
            <option>035--1015410--66</option>
            <option>036--1015411--infinite</option>
            <option>037--1015415--534</option>
            <option>038--1015420--43</option>
            <option>039--1015421--48</option>
            <option>040--1015425--4432</option>
            <option>041--1015450--53</option>
            <option>042--1015451--48</option>
            <option>043--1015455--67</option>
            <option>044--1040010--54</option>
            <option>045--1040012--296</option>
            <option>046--1040020--1660</option>
            <option>047--1040022--970</option>
            <option>048--1040050--71</option>
            <option>049--1040052--102</option>
            <option>050--1040101--289</option>
            <option>051--1040102--97</option>
            <option>052--1040105--110</option>
            <option>053--104015--57</option>
            <option>054--1040510--1545</option>
            <option>055--1040512--569804</option>
            <option>056--1040521--1020</option>
            <option>057--1040524--10795</option>
            <option>058--1040550--451</option>
            <option>059--1040555--451</option>
            <option>060--1042010--918339</option>
            <option>061--1042015--unknown</option>
            <option>062--1042020--57493855205939</option>
            <option>063--1042022--57493855205905</option>
            <option>064--104205--infinite</option>
            <option>065--1042110--631</option>
            <option>066--1042115--118</option>
            <option>067--1042120--2056</option>
            <option>068--1042122--747</option>
            <option>069--1042150--5865</option>
            <option>070--1042155--398</option>
            <option>071--1042501--1550</option>
            <option>072--1042502--130</option>
            <option>073--1042505--153</option>
            <option>074--1042521--2754</option>
            <option>075--1042522--196</option>
            <option>076--1042525--122</option>
            <option>077--1044001--infinite</option>
            <option>078--1044002--infinite</option>
            <option>079--1044005--46</option>
            <option>080--1044011--infinite</option>
            <option>081--1044012--infinite</option>
            <option>082--1044015--212</option>
            <option>083--1044051--330</option>
            <option>084--1044052--infinite</option>
            <option>085--1044055--138</option>
            <option>086--1044201--infinite</option>
            <option>087--1044202--infinite</option>
            <option>088--1044205--17859</option>
            <option>089--104421--infinite</option>
            <option>090--1044251--347</option>
            <option>091--1044252--infinite</option>
            <option>092--1044255--73</option>
            <option>093--1051--28</option>
            <option>094--1054--28</option>
            <option>095--120012--110</option>
            <option>096--1200141--247</option>
            <option>097--1200142--309</option>
            <option>098--1200145--181</option>
            <option>099--1200412--infinite</option>
            <option>100--1200414--711</option>
            <option>101--1200422--5132</option>
            <option>102--1200424--345</option>
            <option>103--1200452--1515</option>
            <option>104--1200454--839</option>
            <option>105--1200521--304</option>
            <option>106--1200522--354</option>
            <option>107--1200525--631</option>
            <option>108--1200541--3943</option>
            <option>109--1200542--201</option>
            <option>110--1200545--237</option>
            <option>111--1202--infinite</option>
            <option>112--1204141--176</option>
            <option>113--1204142--735</option>
            <option>114--1204145--92</option>
            <option>115--120415--57</option>
            <option>116--1204412--415</option>
            <option>117--1204414--infinite</option>
            <option>118--120442--infinite</option>
            <option>119--1204454--2578</option>
            <option>120--1204455--2578</option>
            <option>121--12045--infinite</option>
            <option>122--121401--48</option>
            <option>123--1214041--77</option>
            <option>124--1214042--609</option>
            <option>125--1214045--114</option>
            <option>126--1214051--22847</option>
            <option>127--1214052--infinite</option>
            <option>128--1214055--134</option>
            <option>129--121421--29</option>
            <option>130--1214241--105</option>
            <option>131--1214242--7882</option>
            <option>132--1214245--45</option>
            <option>133--1214251--281</option>
            <option>134--1214252--62</option>
            <option>135--1214255--152</option>
            <option>136--1214411--infinite</option>
            <option>137--1214412--48</option>
            <option>138--1214415--48</option>
            <option>139--121444--infinite</option>
            <option>140--121445--infinite</option>
            <option>141--121510--33</option>
            <option>142--121512--99</option>
            <option>143--121514--48</option>
            <option>144--1215401--151</option>
            <option>145--1215402--42</option>
            <option>146--1215405--53</option>
            <option>147--1215421--2526</option>
            <option>148--1215422--2857</option>
            <option>149--1215425--561</option>
            <option>150--121544--33</option>
            <option>151--12155--28</option>
            <option>152--1251--48</option>
            <option>153--1252101--220142</option>
            <option>154--1252104--7584</option>
            <option>155--1252105--9260</option>
            <option>156--1252121--infinite</option>
            <option>157--1252124--2565</option>
            <option>158--1252125--731</option>
            <option>159--1252141--553</option>
            <option>160--1252144--173</option>
            <option>161--1252145--infinite</option>
            <option>162--12522--infinite</option>
            <option>163--1252501--248</option>
            <option>164--1252504--236</option>
            <option>165--1252505--101</option>
            <option>166--1252521--1063</option>
            <option>167--1252524--162</option>
            <option>168--1252525--86</option>
            <option>169--1252541--514</option>
            <option>170--1252544--1116</option>
            <option>171--1252545--738</option>
            <option>172--1420011--83</option>
            <option>173--1420012--81</option>
            <option>174--1420015--94</option>
            <option>175--1420041--infinite</option>
            <option>176--1420042--897</option>
            <option>177--1420045--285</option>
            <option>178--1420051--90</option>
            <option>179--1420052--73</option>
            <option>180--1420055--697</option>
            <option>181--1420211--infinite</option>
            <option>182--1420214--infinite</option>
            <option>183--1420215--infinite</option>
            <option>184--1420221--infinite</option>
            <option>185--1420224--16811365528</option>
            <option>187--142025--34</option>
            <option>188--142041--90</option>
            <option>189--1420441--50</option>
            <option>190--1420442--infinite</option>
            <option>191--1420445--1688</option>
            <option>192--1420451--4419</option>
            <option>193--1420452--3566</option>
            <option>194--1420455--496</option>
            <option>195--142101--29</option>
            <option>196--1421041--50</option>
            <option>197--1421042--248</option>
            <option>198--1421045--39</option>
            <option>199--1421051--73</option>
            <option>200--1421052--5715</option>
            <option>201--1421055--infinite</option>
            <option>202--1421211--33</option>
            <option>203--1421214--219</option>
            <option>204--1421215--79</option>
            <option>205--1421221--23</option>
            <option>206--1421224--3793</option>
            <option>207--1421225--46</option>
            <option>208--1421251--29</option>
            <option>209--1421254--52</option>
            <option>210--1421255--infinite</option>
            <option>211--1421411--infinite</option>
            <option>212--1421412--29</option>
            <option>213--1421415--35</option>
            <option>214--142144--infinite</option>
            <option>215--142145--infinite</option>
            <option>216--14251--48</option>
            <option>217--14252--infinite</option>
            <option>218--14255--44</option>
            <option>219--1450011--83</option>
            <option>220--1450012--81</option>
            <option>221--1450015--94</option>
            <option>222--1450041--infinite</option>
            <option>223--1450042--897</option>
            <option>224--1450045--285</option>
            <option>225--1450051--90</option>
            <option>226--1450052--73</option>
            <option>227--1450055--697</option>
            <option>228--1450211--infinite</option>
            <option>229--1450214--infinite</option>
            <option>230--1450215--infinite</option>
            <option>231--1450221--infinite</option>
            <option>232--1450224--16811365528</option>
            <option>233--1450225--284</option>
            <option>234--145025--34</option>
            <option>235--145041--90</option>
            <option>236--1450441--50</option>
            <option>237--1450442--infinite</option>
            <option>238--1450445--1688</option>
            <option>239--1450451--4419</option>
            <option>240--1450452--3566</option>
            <option>241--1450455--496</option>
            <option>242--145101--29</option>
            <option>243--1451041--50</option>
            <option>244--1451042--248</option>
            <option>245--1451045--39</option>
            <option>246--1451051--73</option>
            <option>247--1451052--5715</option>
            <option>248--1451055--infinite</option>
            <option>249--1451211--33</option>
            <option>250--1451214--219</option>
            <option>251--1451215--79</option>
            <option>252--1451221--23</option>
            <option>253--1451224--3793</option>
            <option>254--1451225--46</option>
            <option>255--1451251--29</option>
            <option>256--1451254--52</option>
            <option>257--1451255--infinite</option>
            <option>258--1451411--infinite</option>
            <option>259--1451412--29</option>
            <option>260--1451415--35</option>
            <option>261--145144--infinite</option>
            <option>262--145145--infinite</option>
            <option>263--14551--48</option>
            <option>264--14552--infinite</option>
            <option>265--14555--44</option>
            <option>266--150011--50</option>
            <option>267--150015--33</option>
            <option>268--1500411--196</option>
            <option>269--1500415--69</option>
            <option>270--1500421--732</option>
            <option>271--1500425--159</option>
            <option>272--1500451--78</option>
            <option>273--1500455--45</option>
            <option>274--15005--infinite</option>
            <option>275--150111--33</option>
            <option>276--150115--29</option>
            <option>277--1501411--55</option>
            <option>278--1501412--71</option>
            <option>279--1501415--44</option>
            <option>280--1501451--140</option>
            <option>281--1501452--113</option>
            <option>282--1501455--119</option>
            <option>283--1501511--1672</option>
            <option>284--1501515--10307</option>
            <option>285--1501521--infinite</option>
            <option>286--1501525--165</option>
            <option>287--1501551--134</option>
            <option>288--1501555--112</option>
            <option>289--1505111--52549</option>
            <option>290--1505115--infinite</option>
            <option>291--1505141--1632</option>
            <option>292--1505145--1632</option>
            <option>293--1505151--1978</option>
            <option>294--1505155--5148</option>
            <option>295--1505211--419</option>
            <option>296--1505215--1564</option>
            <option>297--1505241--4371</option>
            <option>298--1505245--7143</option>
            <option>299--1505251--454</option>
            <option>300--1505255--306</option>
            <option>301--1505511--62</option>
            <option>302--1505514--130</option>
            <option>303--1505515--55</option>
            <option>304--1505551--636</option>
            <option>305--1505554--206</option>
            <option>306--1505555--242</option>
            <option>307--1520--infinite</option>
            <option>308--152111--33</option>
            <option>309--152115--29</option>
            <option>310--1521411--148</option>
            <option>311--1521415--247</option>
            <option>312--1521421--393</option>
            <option>313--1521425--113</option>
            <option>314--1521451--136</option>
            <option>315--1521455--132</option>
            <option>316--1521511--623</option>
            <option>317--1521515--2377</option>
            <option>318--1521521--176</option>
            <option>319--1521525--1742</option>
            <option>320--1521551--152</option>
            <option>321--1521555--112</option>
            <option>322--1525111--534</option>
            <option>323--1525115--infinite</option>
            <option>324--1525121--356</option>
            <option>325--1525125--606</option>
            <option>326--1525151--533</option>
            <option>327--1525155--287</option>
            <option>328--1525411--2754</option>
            <option>329--1525412--infinite</option>
            <option>330--1525415--126</option>
            <option>331--1525451--5708</option>
            <option>332--1525452--infinite</option>
            <option>333--1525455--338</option>
            <option>334--1525511--83618</option>
            <option>335--1525515--1574</option>
            <option>336--1525521--7275</option>
            <option>337--1525525--843</option>
            <option>338--1525551--262</option>
            <option>339--1525555--286</option>
            <option>340--1541011--194</option>
            <option>341--1541012--294</option>
            <option>342--1541015--180</option>
            <option>343--1541051--354</option>
            <option>344--1541052--107</option>
            <option>345--1541055--708</option>
            <option>346--154111--infinite</option>
            <option>347--1541121--48</option>
            <option>348--1541125--114</option>
            <option>349--1541151--48</option>
            <option>350--1541155--58</option>
            <option>351--1541511--2811</option>
            <option>352--1541515--663</option>
            <option>353--1541521--infinite</option>
            <option>354--1541525--infinite</option>
            <option>355--1541551--245</option>
            <option>356--1541555--321</option>
            <option>357--1544101--infinite</option>
            <option>358--1544102--infinite</option>
            <option>359--1544105--45477</option>
            <option>360--154411--infinite</option>
            <option>361--1544151--558</option>
            <option>362--1544152--infinite</option>
            <option>363--1544155--7565</option>
            <option>364--1544501--infinite</option>
            <option>365--1544502--infinite</option>
            <option>366--1544505--512</option>
            <option>367--1544511--infinite</option>
            <option>368--1544512--infinite</option>
            <option>369--1544515--1457</option>
            <option>370--1544551--4802</option>
            <option>371--1544552--infinite</option>
            <option>372--1544555--138</option>
            <option>373--1545--infinite</option>
            <option>374--200--9</option>
            <option>375--2010--15</option>
            <option>376--20140--30</option>
            <option>377--201412--45</option>
            <option>378--2014141--609</option>
            <option>379--2014142--3563608205</option>
            <option>380--2014144--615</option>
            <option>381--201415--37</option>
            <option>382--20142--27</option>
            <option>383--2015--infinite</option>
            <option>384--2104--12</option>
            <option>385--2105--21</option>
            <option>386--2144--18</option>
            <option>387--21450--63</option>
            <option>388--2145121--438</option>
            <option>389--2145122--438</option>
            <option>390--2145124--411</option>
            <option>186--1420225--284</option>
            <option>393--2145144--2373</option>
            <option>394--214515--68</option>
            <option>395--21452--48</option>
            <option>396--215--infinite</option>
            <option>397--244--9</option>
            <option>398--2450--15</option>
            <option>399--24540--30</option>
            <option>400--245412--45</option>
            <option>401--2454141--609</option>
            <option>402--2454142--3563608205</option>
            <option>403--2454144--615</option>
            <option>404--245415--37</option>
            <option>405--24542--27</option>
            <option>406--2455--infinite</option>
            <option>407--2510--12</option>
            <option>408--2514--18</option>
            <option>409--2515--infinite</option>
            <option>410--2540--12</option>
            <option>411--2544--18</option>
            <option>412--2545--infinite</option>
          </select>
        <input type="submit" value="Submit"/>
      </form>
    </body>
  </foreignObject>
 <g id="Lines">
 </g>
</svg> 